---
import { BOOKING_LINK } from '../../config/bookingLink'
---

<div
	id="booking-modal"
	class="booking-modal hidden fixed inset-0 z-[80] items-center justify-center bg-black/70 px-4"
>
	<div class="relative w-full max-w-xl rounded-2xl bg-white p-8 text-neutral-700 shadow-2xl dark:bg-neutral-900 dark:text-neutral-100">
		<button
			type="button"
			class="absolute right-4 top-4 inline-flex h-10 w-10 items-center justify-center rounded-full bg-neutral-100 text-neutral-500 transition hover:bg-neutral-200 focus-visible:outline-none dark:bg-neutral-800 dark:text-neutral-200 dark:hover:bg-neutral-700"
			aria-label="Закрыть"
			data-booking-close
		>
			&times;
		</button>
		<h2 class="text-2xl font-semibold text-neutral-900 dark:text-neutral-50">Это демо-превью платформы</h2>
		<p class="mt-4 text-base leading-relaxed">
			Этот сайт показывает, как работает превью «до/после» для продаж.
			<br />
			Тест бота даём только бизнесу: школам, салонам/сетям и тем, кто готов масштабировать.
			<br />
			Хотите посмотреть сценарий и задать вопросы — запишитесь на онлайн-демо.
		</p>
		<div class="mt-8 flex flex-col gap-3 sm:flex-row sm:justify-end">
			<button
				type="button"
				class="inline-flex items-center justify-center rounded-full bg-neutral-100 px-6 py-3 text-sm font-semibold text-neutral-600 transition hover:bg-neutral-200 focus-visible:outline-none dark:bg-neutral-800 dark:text-neutral-200 dark:hover:bg-neutral-700"
				data-booking-close
			>
				Отмена
			</button>
			<a
				href={BOOKING_LINK}
				target="_blank"
				rel="noopener noreferrer"
				class="inline-flex items-center justify-center rounded-full bg-primary-500 px-6 py-3 text-sm font-semibold text-white shadow-lg shadow-primary-500/30 transition hover:bg-primary-600 focus-visible:outline-none"
			>
				Записаться на онлайн-демо
			</a>
		</div>
	</div>
</div>

<script>
	const modal = document.getElementById('booking-modal');
	const closeButtons = modal?.querySelectorAll('[data-booking-close]');

	const openModal = () => {
		if (!modal) return;
		modal.classList.remove('hidden');
		document.body.classList.add('overflow-hidden');
	};

	const closeModal = () => {
		if (!modal) return;
		modal.classList.add('hidden');
		document.body.classList.remove('overflow-hidden');
	};

	document.addEventListener('click', (event) => {
		const target = event.target;
		if (!(target instanceof Element)) return;
		const trigger = target.closest('[data-booking-link="true"]');
		if (trigger instanceof HTMLElement) {
			event.preventDefault();
			const link = trigger.getAttribute('data-booking-url') || '';
			if (link) {
				window.open(link, '_blank', 'noopener,noreferrer');
			} else {
				openModal();
			}
		}
	});

	closeButtons?.forEach((button) =>
		button.addEventListener('click', () => {
			closeModal();
		})
	);

	modal?.addEventListener('click', (event) => {
		if (event.target === modal) {
			closeModal();
		}
	});

	document.addEventListener('keydown', (event) => {
		if (event.key === 'Escape') {
			closeModal();
		}
	});
</script>

<style>
	.booking-modal.hidden {
		display: none;
	}
	.booking-modal {
		display: flex;
	}
</style>
